var init = {
        refreshInterval: 10000,
        frameID: document.getElementById("ext-comp-1011").contentWindow.document,
        fReport: document.getElementById("ext-comp-1011").contentWindow.document.getElementsByClassName('bFilterReport')[0],
        notifOptions: {
            body: "Unassigned tickets in the queue",
            icon: "https://brand.pearson.com/etc/designs/corporate/global/brand/favicon.ico"
        },
        run: function() {
            if (init.frameID.getElementById('scope').value !== "queue") {
                alert("Please ensure you are in the 'Queue owned cases' report");
                throw new Error('Incorrect queue selected');
            } else {
                if (document.getElementById('ext-gen43').childNodes[0].innerText !== "Auto refresh running every " + init.refreshInterval / 1000 + " seconds") {
                    document.getElementById('scc_widget_Quick_Create_button').insertAdjacentHTML("beforebegin", "<p style=color:white>Auto refresh running every " + init.refreshInterval / 1000 + " seconds</p>");
                } else {
                    document.getElementsByTagName('p')[0].remove();
                    throw new Error("stopping auto refresh");
                }
            }
        },
        refresh: function() {
            setTimeout(init.refresh, init.refreshInterval);
            init.frameID.location.reload();
            if (init.frameID.getElementsByClassName('grandTotal grandTotalTop')[0].innerText !== 'Grand Totals(0 records)') {
                new Notification("L2 Tickets", init.notifOptions);
            }
        }
    }
